## L2 = 1.5e-6

====================| Epoch [17] Done | It has took [419.50] min, Avg time: [1480.59] sec/epoch | Estimate time for [200] epochs: [4935.29] min | Epoch took [11559] sec |  xray-clinical-cl_accuracy Patience [6] |====================
==============================Trained Models==============================
==========================================================================
====================Training model: [512_image_clinical_resnet50]====================
========================================For Training [512_image_clinical_resnet50]========================================
ModelSetup(get_performance_iou=None, get_performance_areaRng='all', name='512_image_clinical_resnet50', sources=['xrays', 'clinical_1d'], tasks=['xray-clinical-cl'], fusor='no-action', using_backbone_for_clinical=True, decoder_channels=[128, 64, 32, 16, 8], lesion_label_cols=['Pulmonary edema', 'Enlarged cardiac silhouette', 'Consolidation', 'Atelectasis', 'Pleural abnormality'], save_early_stop_model=True, normalise_clinical_num=True, record_training_performance=False, backbone='resnet50', optimiser='sgd', lr=0.003, weight_decay=1.5e-06, sgb_momentum=0.9, image_backbone_pretrained=True, heatmap_backbone_pretrained=False, image_size=512, image_mean=[0.485, 0.456, 0.406], image_std=[0.229, 0.224, 0.225], backbone_out_channels=64, batch_size=16, warmup_epochs=10, model_warmup_epochs=0, loss_warmup_epochs=0, lr_scheduler='ReduceLROnPlateau', reduceLROnPlateau_factor=0.9999999999, reduceLROnPlateau_patience=9999999, reduceLROnPlateau_full_stop=True, multiStepLR_milestones=[20, 40, 60, 80, 100], multiStepLR_gamma=0.5, representation_size=64, mask_hidden_layers=64, using_fpn=False, lesion_detection_use_mask=True, fuse_conv_channels=32, box_head_dropout_rate=0, fuse_depth=4, fusion_strategy='concat', fusion_residule=False, gt_in_train_till=0, measure_test=True, eval_freq=10, use_iobb=True, iou_thrs=array([0.5 , 0.55, 0.6 , 0.65, 0.7 , 0.75, 0.8 , 0.85, 0.9 , 0.95]), maxDets=[1, 5, 10, 30], fiaxtions_mode_input='reporting', fiaxtions_mode_label='reporting', clinical_num=[], clinical_cat=['sbp_discrete', 'dbp_discrete', 'o2sat_discrete', 'resprate_discrete', 'heartrate_discrete', 'temperature_discrete', 'age_discrete', 'acuity_discrete', 'gender'], categorical_col_maps={'sbp_discrete': 3, 'dbp_discrete': 3, 'o2sat_discrete': 4, 'resprate_discrete': 3, 'heartrate_discrete': 3, 'temperature_discrete': 4, 'age_discrete': 2, 'acuity_discrete': 5, 'gender': 2}, clinical_cat_emb_dim=16, clinical_conv_channels=32, clinical_upsample='deconv', chexpert_label_cols=['Atelectasis_chexpert', 'Cardiomegaly_chexpert', 'Consolidation_chexpert', 'Edema_chexpert', 'Enlarged Cardiomediastinum_chexpert', 'Fracture_chexpert', 'Lung Lesion_chexpert', 'Lung Opacity_chexpert', 'No Finding_chexpert', 'Pleural Effusion_chexpert', 'Pleural Other_chexpert', 'Pneumonia_chexpert', 'Pneumothorax_chexpert', 'Support Devices_chexpert'], negbio_label_cols=['Atelectasis_negbio', 'Cardiomegaly_negbio', 'Consolidation_negbio', 'Edema_negbio', 'Enlarged Cardiomediastinum_negbio', 'Fracture_negbio', 'Lung Lesion_negbio', 'Lung Opacity_negbio', 'No Finding_negbio', 'Pleural Effusion_negbio', 'Pleural Other_negbio', 'Pneumonia_negbio', 'Pneumothorax_negbio', 'Support Devices_negbio'], performance_standards=[{'task': 'xray-clinical-cl', 'metric': 'accuracy'}], random_flip=True, use_clinical_df=True, use_physionet_df=True, use_dynamic_weight=True, with_clinical_label=False, clinical_lesion_detection_use_1D_fusion=False, including_clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], including_clinical_cat=['gender'], clinical_use_expander=False, objectness_pos_weight=1, real_stop_patience=99999999999999999, cl_temp=0.1, cl_lambda_0=0.5, cl_pretrained_load_params=[], cl_pj_dim=16)
==========================================================================================================================

Best performance model has been saved to: [{'xray-clinical-cl_accuracy': 'xray-clinical-cl_val_accuracy_0_3308_test_accuracy_0_3371_epoch11_07-06-2023 01-41-03_512_image_clinical_resnet50'}]
The final model has been saved to: [xray-clinical-cl_val_accuracy_0_3308_test_accuracy_0_3371_epoch11_07-06-2023 01-41-03_512_image_clinical_resnet50]

==========================================================================================================================

## L2 = 3e-4


====================| Epoch [24] Done | It has took [237.17] min, Avg time: [592.92] sec/epoch | Estimate time for [200] epochs: [1976.39] min | Epoch took [9929] sec |  xray-clinical-cl_accuracy Patience [13] |====================
==============================Trained Models==============================
==========================================================================
====================Training model: [512_image_clinical_resnet50]====================
========================================For Training [512_image_clinical_resnet50]========================================
ModelSetup(get_performance_iou=None, get_performance_areaRng='all', name='512_image_clinical_resnet50', sources=['xrays', 'clinical_1d'], tasks=['xray-clinical-cl'], fusor='no-action', using_backbone_for_clinical=True, decoder_channels=[128, 64, 32, 16, 8], lesion_label_cols=['Pulmonary edema', 'Enlarged cardiac silhouette', 'Consolidation', 'Atelectasis', 'Pleural abnormality'], save_early_stop_model=True, normalise_clinical_num=True, record_training_performance=False, backbone='resnet50', optimiser='sgd', lr=0.0001, weight_decay=0.0001, sgb_momentum=0.9, image_backbone_pretrained=True, heatmap_backbone_pretrained=False, image_size=512, image_mean=[0.485, 0.456, 0.406], image_std=[0.229, 0.224, 0.225], backbone_out_channels=64, batch_size=16, warmup_epochs=10, model_warmup_epochs=0, loss_warmup_epochs=0, lr_scheduler='ReduceLROnPlateau', reduceLROnPlateau_factor=0.9999999999, reduceLROnPlateau_patience=9999999, reduceLROnPlateau_full_stop=True, multiStepLR_milestones=[20, 40, 60, 80, 100], multiStepLR_gamma=0.5, representation_size=64, mask_hidden_layers=64, using_fpn=False, lesion_detection_use_mask=True, fuse_conv_channels=32, box_head_dropout_rate=0, fuse_depth=4, fusion_strategy='concat', fusion_residule=False, gt_in_train_till=0, measure_test=True, eval_freq=10, use_iobb=True, iou_thrs=array([0.5 , 0.55, 0.6 , 0.65, 0.7 , 0.75, 0.8 , 0.85, 0.9 , 0.95]), maxDets=[1, 5, 10, 30], fiaxtions_mode_input='reporting', fiaxtions_mode_label='reporting', clinical_num=[], clinical_cat=['sbp_discrete', 'dbp_discrete', 'o2sat_discrete', 'resprate_discrete', 'heartrate_discrete', 'temperature_discrete', 'age_discrete', 'acuity_discrete', 'gender'], categorical_col_maps={'sbp_discrete': 3, 'dbp_discrete': 3, 'o2sat_discrete': 4, 'resprate_discrete': 3, 'heartrate_discrete': 3, 'temperature_discrete': 4, 'age_discrete': 2, 'acuity_discrete': 5, 'gender': 2}, clinical_cat_emb_dim=16, clinical_conv_channels=32, clinical_upsample='deconv', chexpert_label_cols=['Atelectasis_chexpert', 'Cardiomegaly_chexpert', 'Consolidation_chexpert', 'Edema_chexpert', 'Enlarged Cardiomediastinum_chexpert', 'Fracture_chexpert', 'Lung Lesion_chexpert', 'Lung Opacity_chexpert', 'No Finding_chexpert', 'Pleural Effusion_chexpert', 'Pleural Other_chexpert', 'Pneumonia_chexpert', 'Pneumothorax_chexpert', 'Support Devices_chexpert'], negbio_label_cols=['Atelectasis_negbio', 'Cardiomegaly_negbio', 'Consolidation_negbio', 'Edema_negbio', 'Enlarged Cardiomediastinum_negbio', 'Fracture_negbio', 'Lung Lesion_negbio', 'Lung Opacity_negbio', 'No Finding_negbio', 'Pleural Effusion_negbio', 'Pleural Other_negbio', 'Pneumonia_negbio', 'Pneumothorax_negbio', 'Support Devices_negbio'], performance_standards=[{'task': 'xray-clinical-cl', 'metric': 'accuracy'}], random_flip=True, use_clinical_df=True, use_physionet_df=True, use_dynamic_weight=True, with_clinical_label=False, clinical_lesion_detection_use_1D_fusion=False, including_clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], including_clinical_cat=['gender'], clinical_use_expander=False, objectness_pos_weight=1, real_stop_patience=99999999999999999, cl_temp=0.1, cl_lambda_0=0.5, cl_pretrained_load_params=[], cl_pj_dim=16)
==========================================================================================================================

Best performance model has been saved to: [{'xray-clinical-cl_accuracy': 'xray-clinical-cl_val_accuracy_0_3275_test_accuracy_0_3245_epoch11_07-08-2023 23-20-01_512_image_clinical_resnet50'}]
The final model has been saved to: [xray-clinical-cl_val_accuracy_0_3275_test_accuracy_0_3245_epoch11_07-08-2023 23-20-01_512_image_clinical_resnet50]

==========================================================================================================================

## ResNet18, 1e-4 L2

====================| Epoch [40] Done | It has took [499.65] min, Avg time: [749.48] sec/epoch | Estimate time for [200] epochs: [2498.25] min | Epoch took [11131] sec |  xray-clinical-cl_accuracy Patience [23] |====================
==============================Trained Models==============================
==========================================================================
====================Training model: [512_image_clinical_resnet18]====================
========================================For Training [512_image_clinical_resnet18]========================================
ModelSetup(get_performance_iou=None, get_performance_areaRng='all', name='512_image_clinical_resnet18', sources=['xrays', 'clinical_1d'], tasks=['xray-clinical-cl'], fusor='no-action', using_backbone_for_clinical=True, decoder_channels=[128, 64, 32, 16, 8], lesion_label_cols=['Pulmonary edema', 'Enlarged cardiac silhouette', 'Consolidation', 'Atelectasis', 'Pleural abnormality'], save_early_stop_model=True, normalise_clinical_num=True, record_training_performance=False, backbone='resnet18', optimiser='sgd', lr=0.0001, weight_decay=0.0001, sgb_momentum=0.9, image_backbone_pretrained=True, heatmap_backbone_pretrained=False, image_size=512, image_mean=[0.485, 0.456, 0.406], image_std=[0.229, 0.224, 0.225], backbone_out_channels=64, batch_size=16, warmup_epochs=10, model_warmup_epochs=0, loss_warmup_epochs=0, lr_scheduler='ReduceLROnPlateau', reduceLROnPlateau_factor=0.9999999999, reduceLROnPlateau_patience=9999999, reduceLROnPlateau_full_stop=True, multiStepLR_milestones=[20, 40, 60, 80, 100], multiStepLR_gamma=0.5, representation_size=64, mask_hidden_layers=64, using_fpn=False, lesion_detection_use_mask=True, fuse_conv_channels=32, box_head_dropout_rate=0, fuse_depth=4, fusion_strategy='concat', fusion_residule=False, gt_in_train_till=0, measure_test=True, eval_freq=10, use_iobb=True, iou_thrs=array([0.5 , 0.55, 0.6 , 0.65, 0.7 , 0.75, 0.8 , 0.85, 0.9 , 0.95]), maxDets=[1, 5, 10, 30], fiaxtions_mode_input='reporting', fiaxtions_mode_label='reporting', clinical_num=[], clinical_cat=['sbp_discrete', 'dbp_discrete', 'o2sat_discrete', 'resprate_discrete', 'heartrate_discrete', 'temperature_discrete', 'age_discrete', 'acuity_discrete', 'gender'], categorical_col_maps={'sbp_discrete': 3, 'dbp_discrete': 3, 'o2sat_discrete': 4, 'resprate_discrete': 3, 'heartrate_discrete': 3, 'temperature_discrete': 4, 'age_discrete': 2, 'acuity_discrete': 5, 'gender': 2}, clinical_cat_emb_dim=16, clinical_conv_channels=32, clinical_upsample='deconv', chexpert_label_cols=['Atelectasis_chexpert', 'Cardiomegaly_chexpert', 'Consolidation_chexpert', 'Edema_chexpert', 'Enlarged Cardiomediastinum_chexpert', 'Fracture_chexpert', 'Lung Lesion_chexpert', 'Lung Opacity_chexpert', 'No Finding_chexpert', 'Pleural Effusion_chexpert', 'Pleural Other_chexpert', 'Pneumonia_chexpert', 'Pneumothorax_chexpert', 'Support Devices_chexpert'], negbio_label_cols=['Atelectasis_negbio', 'Cardiomegaly_negbio', 'Consolidation_negbio', 'Edema_negbio', 'Enlarged Cardiomediastinum_negbio', 'Fracture_negbio', 'Lung Lesion_negbio', 'Lung Opacity_negbio', 'No Finding_negbio', 'Pleural Effusion_negbio', 'Pleural Other_negbio', 'Pneumonia_negbio', 'Pneumothorax_negbio', 'Support Devices_negbio'], performance_standards=[{'task': 'xray-clinical-cl', 'metric': 'accuracy'}], random_flip=True, use_clinical_df=True, use_physionet_df=True, use_dynamic_weight=True, with_clinical_label=False, clinical_lesion_detection_use_1D_fusion=False, including_clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], including_clinical_cat=['gender'], clinical_use_expander=False, objectness_pos_weight=1, real_stop_patience=99999999999999999, cl_temp=0.1, cl_lambda_0=0.5, cl_pretrained_load_params=[], cl_pj_dim=16)
==========================================================================================================================

Best performance model has been saved to: [{'xray-clinical-cl_accuracy': 'xray-clinical-cl_val_accuracy_0_3338_test_accuracy_0_3281_epoch17_07-12-2023 22-08-20_512_image_clinical_resnet18'}]
The final model has been saved to: [xray-clinical-cl_val_accuracy_0_3338_test_accuracy_0_3281_epoch17_07-12-2023 22-08-20_512_image_clinical_resnet18]

==========================================================================================================================


### Augmentation, 

====================| Epoch [4] Done | It has took [677.70] min, Avg time: [10165.50] sec/epoch | Estimate time for [200] epochs: [33885.00] min | Epoch took [38526] sec |  xray-clinical-cl_accuracy Patience [0] |====================
==============================Trained Models==============================
==========================================================================
====================Training model: [512_image_clinical_resnet18]====================
========================================For Training [512_image_clinical_resnet18]========================================
ModelSetup(get_performance_iou=None, get_performance_areaRng='all', name='512_image_clinical_resnet18', sources=['xrays', 'clinical_1d'], tasks=['xray-clinical-cl'], fusor='no-action', using_backbone_for_clinical=True, decoder_channels=[128, 64, 32, 16, 8], lesion_label_cols=['Pulmonary edema', 'Enlarged cardiac silhouette', 'Consolidation', 'Atelectasis', 'Pleural abnormality'], save_early_stop_model=True, normalise_clinical_num=True, record_training_performance=False, backbone='resnet18', optimiser='sgd', lr=0.0001, weight_decay=0.0001, sgb_momentum=0.9, use_aug_for_cl=True, image_backbone_pretrained=True, heatmap_backbone_pretrained=False, image_size=512, image_mean=[0.485, 0.456, 0.406], image_std=[0.229, 0.224, 0.225], backbone_out_channels=64, batch_size=16, warmup_epochs=10, model_warmup_epochs=0, loss_warmup_epochs=0, lr_scheduler='ReduceLROnPlateau', reduceLROnPlateau_factor=0.9999999999, reduceLROnPlateau_patience=9999999, reduceLROnPlateau_full_stop=True, multiStepLR_milestones=[20, 40, 60, 80, 100], multiStepLR_gamma=0.5, representation_size=64, mask_hidden_layers=64, using_fpn=False, lesion_detection_use_mask=True, fuse_conv_channels=32, box_head_dropout_rate=0, fuse_depth=4, fusion_strategy='concat', fusion_residule=False, gt_in_train_till=0, measure_test=True, eval_freq=10, use_iobb=True, iou_thrs=array([0.5 , 0.55, 0.6 , 0.65, 0.7 , 0.75, 0.8 , 0.85, 0.9 , 0.95]), maxDets=[1, 5, 10, 30], fiaxtions_mode_input='reporting', fiaxtions_mode_label='reporting', clinical_num=[], clinical_cat=['sbp_discrete', 'dbp_discrete', 'o2sat_discrete', 'resprate_discrete', 'heartrate_discrete', 'temperature_discrete', 'age_discrete', 'acuity_discrete', 'gender'], categorical_col_maps={'sbp_discrete': 3, 'dbp_discrete': 3, 'o2sat_discrete': 4, 'resprate_discrete': 3, 'heartrate_discrete': 3, 'temperature_discrete': 4, 'age_discrete': 2, 'acuity_discrete': 5, 'gender': 2}, clinical_cat_emb_dim=16, clinical_conv_channels=32, clinical_upsample='deconv', chexpert_label_cols=['Atelectasis_chexpert', 'Cardiomegaly_chexpert', 'Consolidation_chexpert', 'Edema_chexpert', 'Enlarged Cardiomediastinum_chexpert', 'Fracture_chexpert', 'Lung Lesion_chexpert', 'Lung Opacity_chexpert', 'No Finding_chexpert', 'Pleural Effusion_chexpert', 'Pleural Other_chexpert', 'Pneumonia_chexpert', 'Pneumothorax_chexpert', 'Support Devices_chexpert'], negbio_label_cols=['Atelectasis_negbio', 'Cardiomegaly_negbio', 'Consolidation_negbio', 'Edema_negbio', 'Enlarged Cardiomediastinum_negbio', 'Fracture_negbio', 'Lung Lesion_negbio', 'Lung Opacity_negbio', 'No Finding_negbio', 'Pleural Effusion_negbio', 'Pleural Other_negbio', 'Pneumonia_negbio', 'Pneumothorax_negbio', 'Support Devices_negbio'], performance_standards=[{'task': 'xray-clinical-cl', 'metric': 'accuracy'}], random_flip=True, use_clinical_df=True, use_physionet_df=True, use_dynamic_weight=True, with_clinical_label=False, clinical_lesion_detection_use_1D_fusion=False, including_clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], including_clinical_cat=['gender'], clinical_use_expander=False, objectness_pos_weight=1, real_stop_patience=99999999999999999, cl_temp=0.1, cl_lambda_0=0.5, cl_pretrained_load_params=[], cl_pj_dim=16)
==========================================================================================================================

Best performance model has been saved to: [{}]
The final model has been saved to: [None]

==========================================================================================================================
[xray-clinical-cl_performer-contrastive_learning_contrastive-loss]: 1.3138



### continue to run this.

====================| Epoch [60] Done | It has took [717.93] min, Avg time: [717.93] sec/epoch | Estimate time for [200] epochs: [2393.11] min | Epoch took [4155] sec |  xray-clinical-cl_accuracy Patience [3] |====================
==============================Trained Models==============================
==========================================================================
====================Training model: [512_image_clinical_resnet18]====================
========================================For Training [512_image_clinical_resnet18]========================================
ModelSetup(get_performance_iou=None, get_performance_areaRng='all', name='512_image_clinical_resnet18', sources=['xrays', 'clinical_1d'], tasks=['xray-clinical-cl'], fusor='no-action', using_backbone_for_clinical=True, decoder_channels=[128, 64, 32, 16, 8], lesion_label_cols=['Pulmonary edema', 'Enlarged cardiac silhouette', 'Consolidation', 'Atelectasis', 'Pleural abnormality'], save_early_stop_model=True, normalise_clinical_num=True, record_training_performance=False, backbone='resnet18', optimiser='sgd', lr=0.0001, weight_decay=0.0001, sgb_momentum=0.9, use_aug_for_cl=True, image_backbone_pretrained=True, heatmap_backbone_pretrained=False, image_size=512, image_mean=[0.485, 0.456, 0.406], image_std=[0.229, 0.224, 0.225], backbone_out_channels=64, batch_size=16, warmup_epochs=10, model_warmup_epochs=0, loss_warmup_epochs=0, lr_scheduler='ReduceLROnPlateau', reduceLROnPlateau_factor=0.9999999999, reduceLROnPlateau_patience=9999999, reduceLROnPlateau_full_stop=True, multiStepLR_milestones=[20, 40, 60, 80, 100], multiStepLR_gamma=0.5, representation_size=64, mask_hidden_layers=64, using_fpn=False, lesion_detection_use_mask=True, fuse_conv_channels=32, box_head_dropout_rate=0, fuse_depth=4, fusion_strategy='concat', fusion_residule=False, gt_in_train_till=0, measure_test=True, eval_freq=10, use_iobb=True, iou_thrs=array([0.5 , 0.55, 0.6 , 0.65, 0.7 , 0.75, 0.8 , 0.85, 0.9 , 0.95]), maxDets=[1, 5, 10, 30], fiaxtions_mode_input='reporting', fiaxtions_mode_label='reporting', clinical_num=[], clinical_cat=['sbp_discrete', 'dbp_discrete', 'o2sat_discrete', 'resprate_discrete', 'heartrate_discrete', 'temperature_discrete', 'age_discrete', 'acuity_discrete', 'gender'], categorical_col_maps={'sbp_discrete': 3, 'dbp_discrete': 3, 'o2sat_discrete': 4, 'resprate_discrete': 3, 'heartrate_discrete': 3, 'temperature_discrete': 4, 'age_discrete': 2, 'acuity_discrete': 5, 'gender': 2}, clinical_cat_emb_dim=16, clinical_conv_channels=32, clinical_upsample='deconv', chexpert_label_cols=['Atelectasis_chexpert', 'Cardiomegaly_chexpert', 'Consolidation_chexpert', 'Edema_chexpert', 'Enlarged Cardiomediastinum_chexpert', 'Fracture_chexpert', 'Lung Lesion_chexpert', 'Lung Opacity_chexpert', 'No Finding_chexpert', 'Pleural Effusion_chexpert', 'Pleural Other_chexpert', 'Pneumonia_chexpert', 'Pneumothorax_chexpert', 'Support Devices_chexpert'], negbio_label_cols=['Atelectasis_negbio', 'Cardiomegaly_negbio', 'Consolidation_negbio', 'Edema_negbio', 'Enlarged Cardiomediastinum_negbio', 'Fracture_negbio', 'Lung Lesion_negbio', 'Lung Opacity_negbio', 'No Finding_negbio', 'Pleural Effusion_negbio', 'Pleural Other_negbio', 'Pneumonia_negbio', 'Pneumothorax_negbio', 'Support Devices_negbio'], performance_standards=[{'task': 'xray-clinical-cl', 'metric': 'accuracy'}], random_flip=True, use_clinical_df=True, use_physionet_df=True, use_dynamic_weight=True, with_clinical_label=False, clinical_lesion_detection_use_1D_fusion=False, including_clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], including_clinical_cat=['gender'], clinical_use_expander=False, objectness_pos_weight=1, real_stop_patience=99999999999999999, cl_temp=0.1, cl_lambda_0=0.5, cl_pretrained_load_params=[], cl_pj_dim=16)
==========================================================================================================================

Best performance model has been saved to: [{'xray-clinical-cl_accuracy': 'xray-clinical-cl_val_accuracy_0_2866_test_accuracy_0_2779_epoch57_07-22-2023 12-28-51_512_image_clinical_resnet18'}]
The final model has been saved to: [xray-clinical-cl_val_accuracy_0_2866_test_accuracy_0_2779_epoch57_07-22-2023 12-28-51_512_image_clinical_resnet18]

==========================================================================================================================


## Augmentation run ()

====================| Epoch [202] Done | It has took [1202.68] min, Avg time: [357.23] sec/epoch | Estimate time for [209] epochs: [1244.36] min | Epoch took [6667] sec |  xray-clinical-cl_accuracy Patience [28] |====================
==============================Trained Models==============================
==========================================================================
====================Training model: [512_image_clinical_resnet18]====================
========================================For Training [512_image_clinical_resnet18]========================================
ModelSetup(get_performance_iou=None, get_performance_areaRng='all', name='512_image_clinical_resnet18', sources=['xrays', 'clinical_1d'], tasks=['xray-clinical-cl'], fusor='no-action', using_backbone_for_clinical=True, decoder_channels=[128, 64, 32, 16, 8], lesion_label_cols=['Pulmonary edema', 'Enlarged cardiac silhouette', 'Consolidation', 'Atelectasis', 'Pleural abnormality'], save_early_stop_model=True, normalise_clinical_num=True, record_training_performance=False, backbone='resnet18', optimiser='sgd', lr=0.0001, weight_decay=0.0001, sgb_momentum=0.9, use_aug_for_cl=True, image_backbone_pretrained=True, heatmap_backbone_pretrained=False, image_size=512, image_mean=[0.485, 0.456, 0.406], image_std=[0.229, 0.224, 0.225], backbone_out_channels=64, batch_size=16, warmup_epochs=10, model_warmup_epochs=0, loss_warmup_epochs=0, lr_scheduler='ReduceLROnPlateau', reduceLROnPlateau_factor=0.9999999999, reduceLROnPlateau_patience=9999999, reduceLROnPlateau_full_stop=True, multiStepLR_milestones=[20, 40, 60, 80, 100], multiStepLR_gamma=0.5, representation_size=64, mask_hidden_layers=64, using_fpn=False, lesion_detection_use_mask=True, fuse_conv_channels=32, box_head_dropout_rate=0, fuse_depth=4, fusion_strategy='concat', fusion_residule=False, gt_in_train_till=0, measure_test=True, eval_freq=10, use_iobb=True, iou_thrs=array([0.5 , 0.55, 0.6 , 0.65, 0.7 , 0.75, 0.8 , 0.85, 0.9 , 0.95]), maxDets=[1, 5, 10, 30], fiaxtions_mode_input='reporting', fiaxtions_mode_label='reporting', clinical_num=[], clinical_cat=['sbp_discrete', 'dbp_discrete', 'o2sat_discrete', 'resprate_discrete', 'heartrate_discrete', 'temperature_discrete', 'age_discrete', 'acuity_discrete', 'gender'], categorical_col_maps={'sbp_discrete': 3, 'dbp_discrete': 3, 'o2sat_discrete': 4, 'resprate_discrete': 3, 'heartrate_discrete': 3, 'temperature_discrete': 4, 'age_discrete': 2, 'acuity_discrete': 5, 'gender': 2}, clinical_cat_emb_dim=16, clinical_conv_channels=32, clinical_upsample='deconv', chexpert_label_cols=['Atelectasis_chexpert', 'Cardiomegaly_chexpert', 'Consolidation_chexpert', 'Edema_chexpert', 'Enlarged Cardiomediastinum_chexpert', 'Fracture_chexpert', 'Lung Lesion_chexpert', 'Lung Opacity_chexpert', 'No Finding_chexpert', 'Pleural Effusion_chexpert', 'Pleural Other_chexpert', 'Pneumonia_chexpert', 'Pneumothorax_chexpert', 'Support Devices_chexpert'], negbio_label_cols=['Atelectasis_negbio', 'Cardiomegaly_negbio', 'Consolidation_negbio', 'Edema_negbio', 'Enlarged Cardiomediastinum_negbio', 'Fracture_negbio', 'Lung Lesion_negbio', 'Lung Opacity_negbio', 'No Finding_negbio', 'Pleural Effusion_negbio', 'Pleural Other_negbio', 'Pneumonia_negbio', 'Pneumothorax_negbio', 'Support Devices_negbio'], performance_standards=[{'task': 'xray-clinical-cl', 'metric': 'accuracy'}], random_flip=True, use_clinical_df=True, use_physionet_df=True, use_dynamic_weight=True, with_clinical_label=False, clinical_lesion_detection_use_1D_fusion=False, including_clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], including_clinical_cat=['gender'], clinical_use_expander=False, objectness_pos_weight=1, real_stop_patience=99999999999999999, cl_temp=0.1, cl_lambda_0=0.5, cl_pretrained_load_params=[], cl_pj_dim=16)
==========================================================================================================================

Best performance model has been saved to: [{'xray-clinical-cl_accuracy': 'xray-clinical-cl_val_accuracy_0_3132_test_accuracy_0_3065_epoch174_07-30-2023 14-18-01_512_image_clinical_resnet18'}]
The final model has been saved to: [xray-clinical-cl_val_accuracy_0_3132_test_accuracy_0_3065_epoch174_07-30-2023 14-18-01_512_image_clinical_resnet18]

==========================================================================================================================
[xray-clinical-cl_performer-contrastive_learning_contrastive-loss]: 1.1824
backbone weights fix status: False



### fix & baseline & no fix (has last backbone output)

========================================For Training [chexpert_cl_fix]========================================
ModelSetup(get_performance_iou=None, get_performance_areaRng='all', name='chexpert_cl_fix', sources=['xrays'], tasks=['chexpert-classification'], fusor='element-wise sum', using_backbone_for_clinical=True, decoder_channels=[128, 64, 32, 16, 8], lesion_label_cols=['Pulmonary edema', 'Enlarged cardiac silhouette', 'Consolidation', 'Atelectasis', 'Pleural abnormality'], save_early_stop_model=True, normalise_clinical_num=True, record_training_performance=False, backbone='resnet18', optimiser='sgd', lr=0.0001, weight_decay=0.0001, sgb_momentum=0.9, use_aug_for_cl=True, image_backbone_pretrained=True, heatmap_backbone_pretrained=False, image_size=512, image_mean=[0.485, 0.456, 0.406], image_std=[0.229, 0.224, 0.225], backbone_out_channels=64, batch_size=4, warmup_epochs=10, model_warmup_epochs=0, loss_warmup_epochs=0, lr_scheduler='ReduceLROnPlateau', reduceLROnPlateau_factor=0.9999999999, reduceLROnPlateau_patience=9999999, reduceLROnPlateau_full_stop=True, multiStepLR_milestones=[20, 40, 60, 80, 100], multiStepLR_gamma=0.5, representation_size=64, mask_hidden_layers=64, using_fpn=False, lesion_detection_use_mask=True, fuse_conv_channels=32, box_head_dropout_rate=0, fuse_depth=4, fusion_strategy='concat', fusion_residule=False, gt_in_train_till=0, measure_test=True, eval_freq=10, use_iobb=True, iou_thrs=array([0.5 , 0.55, 0.6 , 0.65, 0.7 , 0.75, 0.8 , 0.85, 0.9 , 0.95]), maxDets=[1, 5, 10, 30], fiaxtions_mode_input='reporting', fiaxtions_mode_label='reporting', clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], clinical_cat=['gender'], categorical_col_maps={'gender': 2}, clinical_cat_emb_dim=16, clinical_conv_channels=32, clinical_upsample='deconv', chexpert_label_cols=['Atelectasis_chexpert', 'Cardiomegaly_chexpert', 'Consolidation_chexpert', 'Edema_chexpert', 'Enlarged Cardiomediastinum_chexpert', 'Fracture_chexpert', 'Lung Lesion_chexpert', 'Lung Opacity_chexpert', 'No Finding_chexpert', 'Pleural Effusion_chexpert', 'Pleural Other_chexpert', 'Pneumonia_chexpert', 'Pneumothorax_chexpert', 'Support Devices_chexpert'], negbio_label_cols=['Atelectasis_negbio', 'Cardiomegaly_negbio', 'Consolidation_negbio', 'Edema_negbio', 'Enlarged Cardiomediastinum_negbio', 'Fracture_negbio', 'Lung Lesion_negbio', 'Lung Opacity_negbio', 'No Finding_negbio', 'Pleural Effusion_negbio', 'Pleural Other_negbio', 'Pneumonia_negbio', 'Pneumothorax_negbio', 'Support Devices_negbio'], performance_standards=[{'task': 'chexpert-classification', 'metric': 'auc'}], random_flip=True, use_clinical_df=True, use_physionet_df=False, use_dynamic_weight=True, with_clinical_label=False, clinical_lesion_detection_use_1D_fusion=False, including_clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], including_clinical_cat=['gender'], clinical_use_expander=False, objectness_pos_weight=1, real_stop_patience=99999999999999999, cl_temp=0.1, cl_lambda_0=0.5, cl_pretrained_load_params=[<models.load.CLPretrainedLoadParams object at 0x00000199A555D9D0>], cl_pj_dim=16)
==============================================================================================================

Best performance model has been saved to: [{'chexpert-classification_auc': 'chexpert-classification_val_auc_0_6563_test_auc_0_6099_epoch16_08-01-2023 09-53-30_chexpert_cl_fix'}]
The final model has been saved to: [chexpert-classification_val_auc_0_6147_test_auc_0_6142_epoch200_08-01-2023 15-06-12_chexpert_cl_fix]

==============================================================================================================


========================================For Training [chexpert_baseline]========================================
ModelSetup(get_performance_iou=None, get_performance_areaRng='all', name='chexpert_baseline', sources=['xrays'], tasks=['chexpert-classification'], fusor='element-wise sum', using_backbone_for_clinical=True, decoder_channels=[128, 64, 32, 16, 8], lesion_label_cols=['Pulmonary edema', 'Enlarged cardiac silhouette', 'Consolidation', 'Atelectasis', 'Pleural abnormality'], save_early_stop_model=True, normalise_clinical_num=True, record_training_performance=False, backbone='resnet18', optimiser='sgd', lr=0.0001, weight_decay=0.0001, sgb_momentum=0.9, use_aug_for_cl=True, image_backbone_pretrained=True, heatmap_backbone_pretrained=False, image_size=512, image_mean=[0.485, 0.456, 0.406], image_std=[0.229, 0.224, 0.225], backbone_out_channels=16, batch_size=4, warmup_epochs=10, model_warmup_epochs=0, loss_warmup_epochs=0, lr_scheduler='ReduceLROnPlateau', reduceLROnPlateau_factor=0.9999999999, reduceLROnPlateau_patience=9999999, reduceLROnPlateau_full_stop=True, multiStepLR_milestones=[20, 40, 60, 80, 100], multiStepLR_gamma=0.5, representation_size=64, mask_hidden_layers=64, using_fpn=False, lesion_detection_use_mask=True, fuse_conv_channels=32, box_head_dropout_rate=0, fuse_depth=4, fusion_strategy='concat', fusion_residule=False, gt_in_train_till=0, measure_test=True, eval_freq=10, use_iobb=True, iou_thrs=array([0.5 , 0.55, 0.6 , 0.65, 0.7 , 0.75, 0.8 , 0.85, 0.9 , 0.95]), maxDets=[1, 5, 10, 30], fiaxtions_mode_input='reporting', fiaxtions_mode_label='reporting', clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], clinical_cat=['gender'], categorical_col_maps={'gender': 2}, clinical_cat_emb_dim=16, clinical_conv_channels=32, clinical_upsample='deconv', chexpert_label_cols=['Atelectasis_chexpert', 'Cardiomegaly_chexpert', 'Consolidation_chexpert', 'Edema_chexpert', 'Enlarged Cardiomediastinum_chexpert', 'Fracture_chexpert', 'Lung Lesion_chexpert', 'Lung Opacity_chexpert', 'No Finding_chexpert', 'Pleural Effusion_chexpert', 'Pleural Other_chexpert', 'Pneumonia_chexpert', 'Pneumothorax_chexpert', 'Support Devices_chexpert'], negbio_label_cols=['Atelectasis_negbio', 'Cardiomegaly_negbio', 'Consolidation_negbio', 'Edema_negbio', 'Enlarged Cardiomediastinum_negbio', 'Fracture_negbio', 'Lung Lesion_negbio', 'Lung Opacity_negbio', 'No Finding_negbio', 'Pleural Effusion_negbio', 'Pleural Other_negbio', 'Pneumonia_negbio', 'Pneumothorax_negbio', 'Support Devices_negbio'], performance_standards=[{'task': 'chexpert-classification', 'metric': 'auc'}], random_flip=True, use_clinical_df=True, use_physionet_df=False, use_dynamic_weight=True, with_clinical_label=False, clinical_lesion_detection_use_1D_fusion=False, including_clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], including_clinical_cat=['gender'], clinical_use_expander=False, objectness_pos_weight=1, real_stop_patience=99999999999999999, cl_temp=0.1, cl_lambda_0=0.5, cl_pretrained_load_params=[], cl_pj_dim=16)
================================================================================================================

Best performance model has been saved to: [{'chexpert-classification_auc': 'chexpert-classification_val_auc_0_7130_test_auc_0_7087_epoch114_08-01-2023 18-10-54_chexpert_baseline'}]
The final model has been saved to: [chexpert-classification_val_auc_0_6837_test_auc_0_6835_epoch200_08-01-2023 20-19-54_chexpert_baseline]

================================================================================================================


========================================For Training [chexpert_cl_no_fix]========================================
ModelSetup(get_performance_iou=None, get_performance_areaRng='all', name='chexpert_cl_no_fix', sources=['xrays'], tasks=['chexpert-classification'], fusor='element-wise sum', using_backbone_for_clinical=True, decoder_channels=[128, 64, 32, 16, 8], lesion_label_cols=['Pulmonary edema', 'Enlarged cardiac silhouette', 'Consolidation', 'Atelectasis', 'Pleural abnormality'], save_early_stop_model=True, normalise_clinical_num=True, record_training_performance=False, backbone='resnet18', optimiser='sgd', lr=0.0001, weight_decay=0.0001, sgb_momentum=0.9, use_aug_for_cl=True, image_backbone_pretrained=True, heatmap_backbone_pretrained=False, image_size=512, image_mean=[0.485, 0.456, 0.406], image_std=[0.229, 0.224, 0.225], backbone_out_channels=64, batch_size=4, warmup_epochs=10, model_warmup_epochs=0, loss_warmup_epochs=0, lr_scheduler='ReduceLROnPlateau', reduceLROnPlateau_factor=0.9999999999, reduceLROnPlateau_patience=9999999, reduceLROnPlateau_full_stop=True, multiStepLR_milestones=[20, 40, 60, 80, 100], multiStepLR_gamma=0.5, representation_size=64, mask_hidden_layers=64, using_fpn=False, lesion_detection_use_mask=True, fuse_conv_channels=32, box_head_dropout_rate=0, fuse_depth=4, fusion_strategy='concat', fusion_residule=False, gt_in_train_till=0, measure_test=True, eval_freq=10, use_iobb=True, iou_thrs=array([0.5 , 0.55, 0.6 , 0.65, 0.7 , 0.75, 0.8 , 0.85, 0.9 , 0.95]), maxDets=[1, 5, 10, 30], fiaxtions_mode_input='reporting', fiaxtions_mode_label='reporting', clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], clinical_cat=['gender'], categorical_col_maps={'gender': 2}, clinical_cat_emb_dim=16, clinical_conv_channels=32, clinical_upsample='deconv', chexpert_label_cols=['Atelectasis_chexpert', 'Cardiomegaly_chexpert', 'Consolidation_chexpert', 'Edema_chexpert', 'Enlarged Cardiomediastinum_chexpert', 'Fracture_chexpert', 'Lung Lesion_chexpert', 'Lung Opacity_chexpert', 'No Finding_chexpert', 'Pleural Effusion_chexpert', 'Pleural Other_chexpert', 'Pneumonia_chexpert', 'Pneumothorax_chexpert', 'Support Devices_chexpert'], negbio_label_cols=['Atelectasis_negbio', 'Cardiomegaly_negbio', 'Consolidation_negbio', 'Edema_negbio', 'Enlarged Cardiomediastinum_negbio', 'Fracture_negbio', 'Lung Lesion_negbio', 'Lung Opacity_negbio', 'No Finding_negbio', 'Pleural Effusion_negbio', 'Pleural Other_negbio', 'Pneumonia_negbio', 'Pneumothorax_negbio', 'Support Devices_negbio'], performance_standards=[{'task': 'chexpert-classification', 'metric': 'auc'}], random_flip=True, use_clinical_df=True, use_physionet_df=False, use_dynamic_weight=True, with_clinical_label=False, clinical_lesion_detection_use_1D_fusion=False, including_clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], including_clinical_cat=['gender'], clinical_use_expander=False, objectness_pos_weight=1, real_stop_patience=99999999999999999, cl_temp=0.1, cl_lambda_0=0.5, cl_pretrained_load_params=[<models.load.CLPretrainedLoadParams object at 0x00000199A543ADF0>], cl_pj_dim=16)
=================================================================================================================

Best performance model has been saved to: [{'chexpert-classification_auc': 'chexpert-classification_val_auc_0_7169_test_auc_0_7275_epoch168_08-02-2023 00-53-40_chexpert_cl_no_fix'}]
The final model has been saved to: [chexpert-classification_val_auc_0_6988_test_auc_0_7129_epoch200_08-02-2023 02-00-43_chexpert_cl_no_fix]

=================================================================================================================


### fix & baseline & no fix (no last backbone output)

========================================For Training [chexpert_cl_fix]========================================
ModelSetup(get_performance_iou=None, get_performance_areaRng='all', name='chexpert_cl_fix', sources=['xrays'], tasks=['chexpert-classification'], fusor='element-wise sum', using_backbone_for_clinical=True, decoder_channels=[128, 64, 32, 16, 8], lesion_label_cols=['Pulmonary edema', 'Enlarged cardiac silhouette', 'Consolidation', 'Atelectasis', 'Pleural abnormality'], save_early_stop_model=True, normalise_clinical_num=True, record_training_performance=False, backbone='resnet18', optimiser='sgd', lr=0.0001, weight_decay=0.0001, sgb_momentum=0.9, use_aug_for_cl=True, image_backbone_pretrained=True, heatmap_backbone_pretrained=False, image_size=512, image_mean=[0.485, 0.456, 0.406], image_std=[0.229, 0.224, 0.225], backbone_out_channels=None, batch_size=4, warmup_epochs=10, model_warmup_epochs=0, loss_warmup_epochs=0, lr_scheduler='ReduceLROnPlateau', reduceLROnPlateau_factor=0.9999999999, reduceLROnPlateau_patience=9999999, reduceLROnPlateau_full_stop=True, multiStepLR_milestones=[20, 40, 60, 80, 100], multiStepLR_gamma=0.5, representation_size=64, mask_hidden_layers=64, using_fpn=False, lesion_detection_use_mask=True, fuse_conv_channels=32, box_head_dropout_rate=0, fuse_depth=4, fusion_strategy='concat', fusion_residule=False, gt_in_train_till=0, measure_test=True, eval_freq=10, use_iobb=True, iou_thrs=array([0.5 , 0.55, 0.6 , 0.65, 0.7 , 0.75, 0.8 , 0.85, 0.9 , 0.95]), maxDets=[1, 5, 10, 30], fiaxtions_mode_input='reporting', fiaxtions_mode_label='reporting', clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], clinical_cat=['gender'], categorical_col_maps={'gender': 2}, clinical_cat_emb_dim=16, clinical_conv_channels=32, clinical_upsample='deconv', chexpert_label_cols=['Atelectasis_chexpert', 'Cardiomegaly_chexpert', 'Consolidation_chexpert', 'Edema_chexpert', 'Enlarged Cardiomediastinum_chexpert', 'Fracture_chexpert', 'Lung Lesion_chexpert', 'Lung Opacity_chexpert', 'No Finding_chexpert', 'Pleural Effusion_chexpert', 'Pleural Other_chexpert', 'Pneumonia_chexpert', 'Pneumothorax_chexpert', 'Support Devices_chexpert'], negbio_label_cols=['Atelectasis_negbio', 'Cardiomegaly_negbio', 'Consolidation_negbio', 'Edema_negbio', 'Enlarged Cardiomediastinum_negbio', 'Fracture_negbio', 'Lung Lesion_negbio', 'Lung Opacity_negbio', 'No Finding_negbio', 'Pleural Effusion_negbio', 'Pleural Other_negbio', 'Pneumonia_negbio', 'Pneumothorax_negbio', 'Support Devices_negbio'], performance_standards=[{'task': 'chexpert-classification', 'metric': 'auc'}], random_flip=True, use_clinical_df=True, use_physionet_df=False, use_dynamic_weight=True, with_clinical_label=False, clinical_lesion_detection_use_1D_fusion=False, including_clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], including_clinical_cat=['gender'], clinical_use_expander=False, objectness_pos_weight=1, real_stop_patience=99999999999999999, cl_temp=0.1, cl_lambda_0=0.5, cl_pretrained_load_params=[<models.load.CLPretrainedLoadParams object at 0x000002155D696490>], cl_pj_dim=16)
==============================================================================================================

Best performance model has been saved to: [{'chexpert-classification_auc': 'chexpert-classification_val_auc_0_7317_test_auc_0_7096_epoch182_08-02-2023 15-04-41_chexpert_cl_fix'}]
The final model has been saved to: [chexpert-classification_val_auc_0_6859_test_auc_0_6711_epoch200_08-02-2023 15-35-52_chexpert_cl_fix]

==============================================================================================================

========================================For Training [chexpert_baseline]========================================
ModelSetup(get_performance_iou=None, get_performance_areaRng='all', name='chexpert_baseline', sources=['xrays'], tasks=['chexpert-classification'], fusor='element-wise sum', using_backbone_for_clinical=True, decoder_channels=[128, 64, 32, 16, 8], lesion_label_cols=['Pulmonary edema', 'Enlarged cardiac silhouette', 'Consolidation', 'Atelectasis', 'Pleural abnormality'], save_early_stop_model=True, normalise_clinical_num=True, record_training_performance=False, backbone='resnet18', optimiser='sgd', lr=0.0001, weight_decay=0.0001, sgb_momentum=0.9, use_aug_for_cl=True, image_backbone_pretrained=True, heatmap_backbone_pretrained=False, image_size=512, image_mean=[0.485, 0.456, 0.406], image_std=[0.229, 0.224, 0.225], backbone_out_channels=16, batch_size=4, warmup_epochs=10, model_warmup_epochs=0, loss_warmup_epochs=0, lr_scheduler='ReduceLROnPlateau', reduceLROnPlateau_factor=0.9999999999, reduceLROnPlateau_patience=9999999, reduceLROnPlateau_full_stop=True, multiStepLR_milestones=[20, 40, 60, 80, 100], multiStepLR_gamma=0.5, representation_size=64, mask_hidden_layers=64, using_fpn=False, lesion_detection_use_mask=True, fuse_conv_channels=32, box_head_dropout_rate=0, fuse_depth=4, fusion_strategy='concat', fusion_residule=False, gt_in_train_till=0, measure_test=True, eval_freq=10, use_iobb=True, iou_thrs=array([0.5 , 0.55, 0.6 , 0.65, 0.7 , 0.75, 0.8 , 0.85, 0.9 , 0.95]), maxDets=[1, 5, 10, 30], fiaxtions_mode_input='reporting', fiaxtions_mode_label='reporting', clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], clinical_cat=['gender'], categorical_col_maps={'gender': 2}, clinical_cat_emb_dim=16, clinical_conv_channels=32, clinical_upsample='deconv', chexpert_label_cols=['Atelectasis_chexpert', 'Cardiomegaly_chexpert', 'Consolidation_chexpert', 'Edema_chexpert', 'Enlarged Cardiomediastinum_chexpert', 'Fracture_chexpert', 'Lung Lesion_chexpert', 'Lung Opacity_chexpert', 'No Finding_chexpert', 'Pleural Effusion_chexpert', 'Pleural Other_chexpert', 'Pneumonia_chexpert', 'Pneumothorax_chexpert', 'Support Devices_chexpert'], negbio_label_cols=['Atelectasis_negbio', 'Cardiomegaly_negbio', 'Consolidation_negbio', 'Edema_negbio', 'Enlarged Cardiomediastinum_negbio', 'Fracture_negbio', 'Lung Lesion_negbio', 'Lung Opacity_negbio', 'No Finding_negbio', 'Pleural Effusion_negbio', 'Pleural Other_negbio', 'Pneumonia_negbio', 'Pneumothorax_negbio', 'Support Devices_negbio'], performance_standards=[{'task': 'chexpert-classification', 'metric': 'auc'}], random_flip=True, use_clinical_df=True, use_physionet_df=False, use_dynamic_weight=True, with_clinical_label=False, clinical_lesion_detection_use_1D_fusion=False, including_clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], including_clinical_cat=['gender'], clinical_use_expander=False, objectness_pos_weight=1, real_stop_patience=99999999999999999, cl_temp=0.1, cl_lambda_0=0.5, cl_pretrained_load_params=[], cl_pj_dim=16)
================================================================================================================

Best performance model has been saved to: [{'chexpert-classification_auc': 'chexpert-classification_val_auc_0_7130_test_auc_0_7087_epoch114_08-02-2023 18-51-26_chexpert_baseline'}]
The final model has been saved to: [chexpert-classification_val_auc_0_6837_test_auc_0_6835_epoch200_08-02-2023 21-10-20_chexpert_baseline]

================================================================================================================


========================================For Training [chexpert_cl_no_fix]========================================
ModelSetup(get_performance_iou=None, get_performance_areaRng='all', name='chexpert_cl_no_fix', sources=['xrays'], tasks=['chexpert-classification'], fusor='element-wise sum', using_backbone_for_clinical=True, decoder_channels=[128, 64, 32, 16, 8], lesion_label_cols=['Pulmonary edema', 'Enlarged cardiac silhouette', 'Consolidation', 'Atelectasis', 'Pleural abnormality'], save_early_stop_model=True, normalise_clinical_num=True, record_training_performance=False, backbone='resnet18', optimiser='sgd', lr=0.0001, weight_decay=0.0001, sgb_momentum=0.9, use_aug_for_cl=True, image_backbone_pretrained=True, heatmap_backbone_pretrained=False, image_size=512, image_mean=[0.485, 0.456, 0.406], image_std=[0.229, 0.224, 0.225], backbone_out_channels=None, batch_size=4, warmup_epochs=10, model_warmup_epochs=0, loss_warmup_epochs=0, lr_scheduler='ReduceLROnPlateau', reduceLROnPlateau_factor=0.9999999999, reduceLROnPlateau_patience=9999999, reduceLROnPlateau_full_stop=True, multiStepLR_milestones=[20, 40, 60, 80, 100], multiStepLR_gamma=0.5, representation_size=64, mask_hidden_layers=64, using_fpn=False, lesion_detection_use_mask=True, fuse_conv_channels=32, box_head_dropout_rate=0, fuse_depth=4, fusion_strategy='concat', fusion_residule=False, gt_in_train_till=0, measure_test=True, eval_freq=10, use_iobb=True, iou_thrs=array([0.5 , 0.55, 0.6 , 0.65, 0.7 , 0.75, 0.8 , 0.85, 0.9 , 0.95]), maxDets=[1, 5, 10, 30], fiaxtions_mode_input='reporting', fiaxtions_mode_label='reporting', clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], clinical_cat=['gender'], categorical_col_maps={'gender': 2}, clinical_cat_emb_dim=16, clinical_conv_channels=32, clinical_upsample='deconv', chexpert_label_cols=['Atelectasis_chexpert', 'Cardiomegaly_chexpert', 'Consolidation_chexpert', 'Edema_chexpert', 'Enlarged Cardiomediastinum_chexpert', 'Fracture_chexpert', 'Lung Lesion_chexpert', 'Lung Opacity_chexpert', 'No Finding_chexpert', 'Pleural Effusion_chexpert', 'Pleural Other_chexpert', 'Pneumonia_chexpert', 'Pneumothorax_chexpert', 'Support Devices_chexpert'], negbio_label_cols=['Atelectasis_negbio', 'Cardiomegaly_negbio', 'Consolidation_negbio', 'Edema_negbio', 'Enlarged Cardiomediastinum_negbio', 'Fracture_negbio', 'Lung Lesion_negbio', 'Lung Opacity_negbio', 'No Finding_negbio', 'Pleural Effusion_negbio', 'Pleural Other_negbio', 'Pneumonia_negbio', 'Pneumothorax_negbio', 'Support Devices_negbio'], performance_standards=[{'task': 'chexpert-classification', 'metric': 'auc'}], random_flip=True, use_clinical_df=True, use_physionet_df=False, use_dynamic_weight=True, with_clinical_label=False, clinical_lesion_detection_use_1D_fusion=False, including_clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], including_clinical_cat=['gender'], clinical_use_expander=False, objectness_pos_weight=1, real_stop_patience=99999999999999999, cl_temp=0.1, cl_lambda_0=0.5, cl_pretrained_load_params=[<models.load.CLPretrainedLoadParams object at 0x000002155D696AF0>], cl_pj_dim=16)
=================================================================================================================

Best performance model has been saved to: [{'chexpert-classification_auc': 'chexpert-classification_val_auc_0_7188_test_auc_0_7121_epoch13_08-02-2023 21-33-41_chexpert_cl_no_fix'}]
The final model has been saved to: [chexpert-classification_val_auc_0_6598_test_auc_0_6543_epoch200_08-03-2023 03-38-15_chexpert_cl_no_fix]

=================================================================================================================



This notebook will running on device: [CUDA]
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |       0 B  |       0 B  |       0 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |       0 B  |       0 B  |       0 B  |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |       0 B  |       0 B  |       0 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |       0 B  |       0 B  |       0 B  |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |       0 B  |       0 B  |       0 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |       0 B  |       0 B  |       0 B  |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |       0 B  |       0 B  |       0 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |       0 B  |       0 B  |       0 B  |       0 B  |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|



====================| Epoch [200] Done | It has took [387.85] min, Avg time: [116.36] sec/epoch | Estimate time for [200] epochs: [387.85] min | Epoch took [126] sec |  chexpert-classification_auc Patience [187] |====================
====================| Training Done, start testing! | [200] Epochs Training time: [23273] seconds, Avg time / Epoch: [116.365] seconds====================
====================Best Performance model has been saved to: [{'chexpert-classification_auc': 'chexpert-classification_val_auc_0_7188_test_auc_0_7121_epoch13_08-02-2023 21-33-41_chexpert_cl_no_fix'}]====================
====================The final model has been saved to: [chexpert-classification_val_auc_0_6598_test_auc_0_6543_epoch200_08-03-2023 03-38-15_chexpert_cl_no_fix]====================
========================================For Training [chexpert_cl_fix]========================================
ModelSetup(get_performance_iou=None, get_performance_areaRng='all', name='chexpert_cl_fix', sources=['xrays'], tasks=['chexpert-classification'], fusor='element-wise sum', using_backbone_for_clinical=True, decoder_channels=[128, 64, 32, 16, 8], lesion_label_cols=['Pulmonary edema', 'Enlarged cardiac silhouette', 'Consolidation', 'Atelectasis', 'Pleural abnormality'], save_early_stop_model=True, normalise_clinical_num=True, record_training_performance=False, backbone='resnet18', optimiser='sgd', lr=0.0001, weight_decay=0.0001, sgb_momentum=0.9, use_aug_for_cl=True, image_backbone_pretrained=True, heatmap_backbone_pretrained=False, image_size=512, image_mean=[0.485, 0.456, 0.406], image_std=[0.229, 0.224, 0.225], backbone_out_channels=None, batch_size=4, warmup_epochs=10, model_warmup_epochs=0, loss_warmup_epochs=0, lr_scheduler='ReduceLROnPlateau', reduceLROnPlateau_factor=0.9999999999, reduceLROnPlateau_patience=9999999, reduceLROnPlateau_full_stop=True, multiStepLR_milestones=[20, 40, 60, 80, 100], multiStepLR_gamma=0.5, representation_size=64, mask_hidden_layers=64, using_fpn=False, lesion_detection_use_mask=True, fuse_conv_channels=32, box_head_dropout_rate=0, fuse_depth=4, fusion_strategy='concat', fusion_residule=False, gt_in_train_till=0, measure_test=True, eval_freq=10, use_iobb=True, iou_thrs=array([0.5 , 0.55, 0.6 , 0.65, 0.7 , 0.75, 0.8 , 0.85, 0.9 , 0.95]), maxDets=[1, 5, 10, 30], fiaxtions_mode_input='reporting', fiaxtions_mode_label='reporting', clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], clinical_cat=['gender'], categorical_col_maps={'gender': 2}, clinical_cat_emb_dim=16, clinical_conv_channels=32, clinical_upsample='deconv', chexpert_label_cols=['Atelectasis_chexpert', 'Cardiomegaly_chexpert', 'Consolidation_chexpert', 'Edema_chexpert', 'Enlarged Cardiomediastinum_chexpert', 'Fracture_chexpert', 'Lung Lesion_chexpert', 'Lung Opacity_chexpert', 'No Finding_chexpert', 'Pleural Effusion_chexpert', 'Pleural Other_chexpert', 'Pneumonia_chexpert', 'Pneumothorax_chexpert', 'Support Devices_chexpert'], negbio_label_cols=['Atelectasis_negbio', 'Cardiomegaly_negbio', 'Consolidation_negbio', 'Edema_negbio', 'Enlarged Cardiomediastinum_negbio', 'Fracture_negbio', 'Lung Lesion_negbio', 'Lung Opacity_negbio', 'No Finding_negbio', 'Pleural Effusion_negbio', 'Pleural Other_negbio', 'Pneumonia_negbio', 'Pneumothorax_negbio', 'Support Devices_negbio'], performance_standards=[{'task': 'chexpert-classification', 'metric': 'auc'}], random_flip=True, use_clinical_df=True, use_physionet_df=False, use_dynamic_weight=True, with_clinical_label=False, clinical_lesion_detection_use_1D_fusion=False, including_clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], including_clinical_cat=['gender'], clinical_use_expander=False, objectness_pos_weight=1, real_stop_patience=99999999999999999, cl_temp=0.1, cl_lambda_0=0.5, cl_pretrained_load_params=[<models.load.CLPretrainedLoadParams object at 0x000002155D696490>], cl_pj_dim=16)
==============================================================================================================

Best performance model has been saved to: [{'chexpert-classification_auc': 'chexpert-classification_val_auc_0_7317_test_auc_0_7096_epoch182_08-02-2023 15-04-41_chexpert_cl_fix'}]
The final model has been saved to: [chexpert-classification_val_auc_0_6859_test_auc_0_6711_epoch200_08-02-2023 15-35-52_chexpert_cl_fix]

==============================================================================================================


========================================For Training [chexpert_baseline]========================================
ModelSetup(get_performance_iou=None, get_performance_areaRng='all', name='chexpert_baseline', sources=['xrays'], tasks=['chexpert-classification'], fusor='element-wise sum', using_backbone_for_clinical=True, decoder_channels=[128, 64, 32, 16, 8], lesion_label_cols=['Pulmonary edema', 'Enlarged cardiac silhouette', 'Consolidation', 'Atelectasis', 'Pleural abnormality'], save_early_stop_model=True, normalise_clinical_num=True, record_training_performance=False, backbone='resnet18', optimiser='sgd', lr=0.0001, weight_decay=0.0001, sgb_momentum=0.9, use_aug_for_cl=True, image_backbone_pretrained=True, heatmap_backbone_pretrained=False, image_size=512, image_mean=[0.485, 0.456, 0.406], image_std=[0.229, 0.224, 0.225], backbone_out_channels=16, batch_size=4, warmup_epochs=10, model_warmup_epochs=0, loss_warmup_epochs=0, lr_scheduler='ReduceLROnPlateau', reduceLROnPlateau_factor=0.9999999999, reduceLROnPlateau_patience=9999999, reduceLROnPlateau_full_stop=True, multiStepLR_milestones=[20, 40, 60, 80, 100], multiStepLR_gamma=0.5, representation_size=64, mask_hidden_layers=64, using_fpn=False, lesion_detection_use_mask=True, fuse_conv_channels=32, box_head_dropout_rate=0, fuse_depth=4, fusion_strategy='concat', fusion_residule=False, gt_in_train_till=0, measure_test=True, eval_freq=10, use_iobb=True, iou_thrs=array([0.5 , 0.55, 0.6 , 0.65, 0.7 , 0.75, 0.8 , 0.85, 0.9 , 0.95]), maxDets=[1, 5, 10, 30], fiaxtions_mode_input='reporting', fiaxtions_mode_label='reporting', clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], clinical_cat=['gender'], categorical_col_maps={'gender': 2}, clinical_cat_emb_dim=16, clinical_conv_channels=32, clinical_upsample='deconv', chexpert_label_cols=['Atelectasis_chexpert', 'Cardiomegaly_chexpert', 'Consolidation_chexpert', 'Edema_chexpert', 'Enlarged Cardiomediastinum_chexpert', 'Fracture_chexpert', 'Lung Lesion_chexpert', 'Lung Opacity_chexpert', 'No Finding_chexpert', 'Pleural Effusion_chexpert', 'Pleural Other_chexpert', 'Pneumonia_chexpert', 'Pneumothorax_chexpert', 'Support Devices_chexpert'], negbio_label_cols=['Atelectasis_negbio', 'Cardiomegaly_negbio', 'Consolidation_negbio', 'Edema_negbio', 'Enlarged Cardiomediastinum_negbio', 'Fracture_negbio', 'Lung Lesion_negbio', 'Lung Opacity_negbio', 'No Finding_negbio', 'Pleural Effusion_negbio', 'Pleural Other_negbio', 'Pneumonia_negbio', 'Pneumothorax_negbio', 'Support Devices_negbio'], performance_standards=[{'task': 'chexpert-classification', 'metric': 'auc'}], random_flip=True, use_clinical_df=True, use_physionet_df=False, use_dynamic_weight=True, with_clinical_label=False, clinical_lesion_detection_use_1D_fusion=False, including_clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], including_clinical_cat=['gender'], clinical_use_expander=False, objectness_pos_weight=1, real_stop_patience=99999999999999999, cl_temp=0.1, cl_lambda_0=0.5, cl_pretrained_load_params=[], cl_pj_dim=16)
================================================================================================================

Best performance model has been saved to: [{'chexpert-classification_auc': 'chexpert-classification_val_auc_0_7130_test_auc_0_7087_epoch114_08-02-2023 18-51-26_chexpert_baseline'}]
The final model has been saved to: [chexpert-classification_val_auc_0_6837_test_auc_0_6835_epoch200_08-02-2023 21-10-20_chexpert_baseline]

================================================================================================================


========================================For Training [chexpert_cl_no_fix]========================================
ModelSetup(get_performance_iou=None, get_performance_areaRng='all', name='chexpert_cl_no_fix', sources=['xrays'], tasks=['chexpert-classification'], fusor='element-wise sum', using_backbone_for_clinical=True, decoder_channels=[128, 64, 32, 16, 8], lesion_label_cols=['Pulmonary edema', 'Enlarged cardiac silhouette', 'Consolidation', 'Atelectasis', 'Pleural abnormality'], save_early_stop_model=True, normalise_clinical_num=True, record_training_performance=False, backbone='resnet18', optimiser='sgd', lr=0.0001, weight_decay=0.0001, sgb_momentum=0.9, use_aug_for_cl=True, image_backbone_pretrained=True, heatmap_backbone_pretrained=False, image_size=512, image_mean=[0.485, 0.456, 0.406], image_std=[0.229, 0.224, 0.225], backbone_out_channels=None, batch_size=4, warmup_epochs=10, model_warmup_epochs=0, loss_warmup_epochs=0, lr_scheduler='ReduceLROnPlateau', reduceLROnPlateau_factor=0.9999999999, reduceLROnPlateau_patience=9999999, reduceLROnPlateau_full_stop=True, multiStepLR_milestones=[20, 40, 60, 80, 100], multiStepLR_gamma=0.5, representation_size=64, mask_hidden_layers=64, using_fpn=False, lesion_detection_use_mask=True, fuse_conv_channels=32, box_head_dropout_rate=0, fuse_depth=4, fusion_strategy='concat', fusion_residule=False, gt_in_train_till=0, measure_test=True, eval_freq=10, use_iobb=True, iou_thrs=array([0.5 , 0.55, 0.6 , 0.65, 0.7 , 0.75, 0.8 , 0.85, 0.9 , 0.95]), maxDets=[1, 5, 10, 30], fiaxtions_mode_input='reporting', fiaxtions_mode_label='reporting', clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], clinical_cat=['gender'], categorical_col_maps={'gender': 2}, clinical_cat_emb_dim=16, clinical_conv_channels=32, clinical_upsample='deconv', chexpert_label_cols=['Atelectasis_chexpert', 'Cardiomegaly_chexpert', 'Consolidation_chexpert', 'Edema_chexpert', 'Enlarged Cardiomediastinum_chexpert', 'Fracture_chexpert', 'Lung Lesion_chexpert', 'Lung Opacity_chexpert', 'No Finding_chexpert', 'Pleural Effusion_chexpert', 'Pleural Other_chexpert', 'Pneumonia_chexpert', 'Pneumothorax_chexpert', 'Support Devices_chexpert'], negbio_label_cols=['Atelectasis_negbio', 'Cardiomegaly_negbio', 'Consolidation_negbio', 'Edema_negbio', 'Enlarged Cardiomediastinum_negbio', 'Fracture_negbio', 'Lung Lesion_negbio', 'Lung Opacity_negbio', 'No Finding_negbio', 'Pleural Effusion_negbio', 'Pleural Other_negbio', 'Pneumonia_negbio', 'Pneumothorax_negbio', 'Support Devices_negbio'], performance_standards=[{'task': 'chexpert-classification', 'metric': 'auc'}], random_flip=True, use_clinical_df=True, use_physionet_df=False, use_dynamic_weight=True, with_clinical_label=False, clinical_lesion_detection_use_1D_fusion=False, including_clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], including_clinical_cat=['gender'], clinical_use_expander=False, objectness_pos_weight=1, real_stop_patience=99999999999999999, cl_temp=0.1, cl_lambda_0=0.5, cl_pretrained_load_params=[<models.load.CLPretrainedLoadParams object at 0x000002155D696AF0>], cl_pj_dim=16)
=================================================================================================================

Best performance model has been saved to: [{'chexpert-classification_auc': 'chexpert-classification_val_auc_0_7188_test_auc_0_7121_epoch13_08-02-2023 21-33-41_chexpert_cl_no_fix'}]
The final model has been saved to: [chexpert-classification_val_auc_0_6598_test_auc_0_6543_epoch200_08-03-2023 03-38-15_chexpert_cl_no_fix]

=================================================================================================================


====================chexpert_cl_fix====================
chexpert-classification_auc: chexpert-classification_val_auc_0_7317_test_auc_0_7096_epoch182_08-02-2023 15-04-41_chexpert_cl_fix
chexpert-classification_val_auc_0_6859_test_auc_0_6711_epoch200_08-02-2023 15-35-52_chexpert_cl_fix
====================chexpert_baseline====================
chexpert-classification_auc: chexpert-classification_val_auc_0_7130_test_auc_0_7087_epoch114_08-02-2023 18-51-26_chexpert_baseline
chexpert-classification_val_auc_0_6837_test_auc_0_6835_epoch200_08-02-2023 21-10-20_chexpert_baseline
====================chexpert_cl_no_fix====================
chexpert-classification_auc: chexpert-classification_val_auc_0_7188_test_auc_0_7121_epoch13_08-02-2023 21-33-41_chexpert_cl_no_fix
chexpert-classification_val_auc_0_6598_test_auc_0_6543_epoch200_08-03-2023 03-38-15_chexpert_cl_no_fix
'\nAP based models.\n'
55
chexpert_cl_fix
best at 182 epoch
{'chexpert-classification': {'f1': 0.536964980544747, 'precision': 0.69, 'accuracy': 0.9291666666666667, 'recall': 0.4394904458598726, 'auc': 0.7095679412490433}}
chexpert_baseline
best at 114 epoch
{'chexpert-classification': {'f1': 0.5461847389558233, 'precision': 0.7391304347826086, 'accuracy': 0.9327380952380953, 'recall': 0.43312101910828027, 'auc': 0.7086813237366745}}
chexpert_cl_no_fix
best at 13 epoch
{'chexpert-classification': {'f1': 0.5384615384615385, 'precision': 0.6796116504854369, 'accuracy': 0.9285714285714286, 'recall': 0.445859872611465, 'auc': 0.7120960558067173}}


# baseline - using 20 epoch as the warmup limitation.

========================================For Training [chexpert_baseline]========================================
ModelSetup(get_performance_iou=None, get_performance_areaRng='all', name='chexpert_baseline', sources=['xrays'], tasks=['chexpert-classification'], fusor='element-wise sum', using_backbone_for_clinical=True, decoder_channels=[128, 64, 32, 16, 8], lesion_label_cols=['Pulmonary edema', 'Enlarged cardiac silhouette', 'Consolidation', 'Atelectasis', 'Pleural abnormality'], save_early_stop_model=True, normalise_clinical_num=True, record_training_performance=False, backbone='resnet18', optimiser='sgd', lr=0.0001, weight_decay=0.0001, sgb_momentum=0.9, use_aug_for_cl=True, image_backbone_pretrained=True, heatmap_backbone_pretrained=False, image_size=512, image_mean=[0.485, 0.456, 0.406], image_std=[0.229, 0.224, 0.225], backbone_out_channels=None, batch_size=4, warmup_epochs=20, model_warmup_epochs=0, loss_warmup_epochs=0, lr_scheduler='ReduceLROnPlateau', reduceLROnPlateau_factor=0.9999999999, reduceLROnPlateau_patience=9999999, reduceLROnPlateau_full_stop=True, multiStepLR_milestones=[20, 40, 60, 80, 100], multiStepLR_gamma=0.5, representation_size=64, mask_hidden_layers=64, using_fpn=False, lesion_detection_use_mask=True, fuse_conv_channels=32, box_head_dropout_rate=0, fuse_depth=4, fusion_strategy='concat', fusion_residule=False, gt_in_train_till=0, measure_test=True, eval_freq=10, use_iobb=True, iou_thrs=array([0.5 , 0.55, 0.6 , 0.65, 0.7 , 0.75, 0.8 , 0.85, 0.9 , 0.95]), maxDets=[1, 5, 10, 30], fiaxtions_mode_input='reporting', fiaxtions_mode_label='reporting', clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], clinical_cat=['gender'], categorical_col_maps={'gender': 2}, clinical_cat_emb_dim=16, clinical_conv_channels=32, clinical_upsample='deconv', chexpert_label_cols=['Atelectasis_chexpert', 'Cardiomegaly_chexpert', 'Consolidation_chexpert', 'Edema_chexpert', 'Enlarged Cardiomediastinum_chexpert', 'Fracture_chexpert', 'Lung Lesion_chexpert', 'Lung Opacity_chexpert', 'No Finding_chexpert', 'Pleural Effusion_chexpert', 'Pleural Other_chexpert', 'Pneumonia_chexpert', 'Pneumothorax_chexpert', 'Support Devices_chexpert'], negbio_label_cols=['Atelectasis_negbio', 'Cardiomegaly_negbio', 'Consolidation_negbio', 'Edema_negbio', 'Enlarged Cardiomediastinum_negbio', 'Fracture_negbio', 'Lung Lesion_negbio', 'Lung Opacity_negbio', 'No Finding_negbio', 'Pleural Effusion_negbio', 'Pleural Other_negbio', 'Pneumonia_negbio', 'Pneumothorax_negbio', 'Support Devices_negbio'], performance_standards=[{'task': 'chexpert-classification', 'metric': 'auc'}], random_flip=True, use_clinical_df=True, use_physionet_df=False, use_dynamic_weight=True, with_clinical_label=False, clinical_lesion_detection_use_1D_fusion=False, including_clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], including_clinical_cat=['gender'], clinical_use_expander=False, objectness_pos_weight=1, real_stop_patience=99999999999999999, cl_temp=0.1, cl_lambda_0=0.5, cl_pretrained_load_params=[], cl_pj_dim=16, use_pytorch_pretrained_backbone=True)
================================================================================================================

Best performance model has been saved to: [{'chexpert-classification_auc': 'chexpert-classification_val_auc_0_7185_test_auc_0_7173_epoch54_08-04-2023 11-48-52_chexpert_baseline'}]
The final model has been saved to: [chexpert-classification_val_auc_0_6598_test_auc_0_6543_epoch200_08-04-2023 16-25-38_chexpert_baseline]

================================================================================================================

# baseline - using 10 


====================| Epoch [200] Done | It has took [298.37] min, Avg time: [89.51] sec/epoch | Estimate time for [200] epochs: [298.37] min | Epoch took [89] sec |  chexpert-classification_auc Patience [187] |====================
====================| Training Done, start testing! | [200] Epochs Training time: [17903] seconds, Avg time / Epoch: [89.515] seconds====================
====================Best Performance model has been saved to: [{'chexpert-classification_auc': 'chexpert-classification_val_auc_0_7188_test_auc_0_7121_epoch13_08-04-2023 18-44-53_chexpert_baseline'}]====================
====================The final model has been saved to: [chexpert-classification_val_auc_0_6598_test_auc_0_6543_epoch200_08-04-2023 23-23-14_chexpert_baseline]====================
========================================For Training [chexpert_baseline]========================================
ModelSetup(get_performance_iou=None, get_performance_areaRng='all', name='chexpert_baseline', sources=['xrays'], tasks=['chexpert-classification'], fusor='element-wise sum', using_backbone_for_clinical=True, decoder_channels=[128, 64, 32, 16, 8], lesion_label_cols=['Pulmonary edema', 'Enlarged cardiac silhouette', 'Consolidation', 'Atelectasis', 'Pleural abnormality'], save_early_stop_model=True, normalise_clinical_num=True, record_training_performance=False, backbone='resnet18', optimiser='sgd', lr=0.0001, weight_decay=0.0001, sgb_momentum=0.9, use_aug_for_cl=True, image_backbone_pretrained=True, heatmap_backbone_pretrained=False, image_size=512, image_mean=[0.485, 0.456, 0.406], image_std=[0.229, 0.224, 0.225], backbone_out_channels=None, batch_size=4, warmup_epochs=10, model_warmup_epochs=0, loss_warmup_epochs=0, lr_scheduler='ReduceLROnPlateau', reduceLROnPlateau_factor=0.9999999999, reduceLROnPlateau_patience=9999999, reduceLROnPlateau_full_stop=True, multiStepLR_milestones=[20, 40, 60, 80, 100], multiStepLR_gamma=0.5, representation_size=64, mask_hidden_layers=64, using_fpn=False, lesion_detection_use_mask=True, fuse_conv_channels=32, box_head_dropout_rate=0, fuse_depth=4, fusion_strategy='concat', fusion_residule=False, gt_in_train_till=0, measure_test=True, eval_freq=10, use_iobb=True, iou_thrs=array([0.5 , 0.55, 0.6 , 0.65, 0.7 , 0.75, 0.8 , 0.85, 0.9 , 0.95]), maxDets=[1, 5, 10, 30], fiaxtions_mode_input='reporting', fiaxtions_mode_label='reporting', clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], clinical_cat=['gender'], categorical_col_maps={'gender': 2}, clinical_cat_emb_dim=16, clinical_conv_channels=32, clinical_upsample='deconv', chexpert_label_cols=['Atelectasis_chexpert', 'Cardiomegaly_chexpert', 'Consolidation_chexpert', 'Edema_chexpert', 'Enlarged Cardiomediastinum_chexpert', 'Fracture_chexpert', 'Lung Lesion_chexpert', 'Lung Opacity_chexpert', 'No Finding_chexpert', 'Pleural Effusion_chexpert', 'Pleural Other_chexpert', 'Pneumonia_chexpert', 'Pneumothorax_chexpert', 'Support Devices_chexpert'], negbio_label_cols=['Atelectasis_negbio', 'Cardiomegaly_negbio', 'Consolidation_negbio', 'Edema_negbio', 'Enlarged Cardiomediastinum_negbio', 'Fracture_negbio', 'Lung Lesion_negbio', 'Lung Opacity_negbio', 'No Finding_negbio', 'Pleural Effusion_negbio', 'Pleural Other_negbio', 'Pneumonia_negbio', 'Pneumothorax_negbio', 'Support Devices_negbio'], performance_standards=[{'task': 'chexpert-classification', 'metric': 'auc'}], random_flip=True, use_clinical_df=True, use_physionet_df=False, use_dynamic_weight=True, with_clinical_label=False, clinical_lesion_detection_use_1D_fusion=False, including_clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], including_clinical_cat=['gender'], clinical_use_expander=False, objectness_pos_weight=1, real_stop_patience=99999999999999999, cl_temp=0.1, cl_lambda_0=0.5, cl_pretrained_load_params=[], cl_pj_dim=16, use_pytorch_pretrained_backbone=True)
================================================================================================================

Best performance model has been saved to: [{'chexpert-classification_auc': 'chexpert-classification_val_auc_0_7188_test_auc_0_7121_epoch13_08-04-2023 18-44-53_chexpert_baseline'}]
The final model has been saved to: [chexpert-classification_val_auc_0_6598_test_auc_0_6543_epoch200_08-04-2023 23-23-14_chexpert_baseline]

================================================================================================================


chexpert_baseline
best at 13 epoch
{'chexpert-classification': {'f1': 0.5384615384615385, 'precision': 0.6796116504854369, 'accuracy': 0.9285714285714286, 'recall': 0.445859872611465, 'auc': 0.7120960558067173}}

## without aug, worse performance


========================================For Training [512_image_clinical_resnet18_woaug]========================================
ModelSetup(get_performance_iou=None, get_performance_areaRng='all', name='512_image_clinical_resnet18_woaug', sources=['xrays', 'clinical_1d'], tasks=['xray-clinical-cl'], fusor='no-action', using_backbone_for_clinical=True, decoder_channels=[128, 64, 32, 16, 8], lesion_label_cols=['Pulmonary edema', 'Enlarged cardiac silhouette', 'Consolidation', 'Atelectasis', 'Pleural abnormality'], save_early_stop_model=True, normalise_clinical_num=True, record_training_performance=False, backbone='resnet18', optimiser='sgd', lr=0.0001, weight_decay=0.0001, sgb_momentum=0.9, use_aug_for_cl=False, image_backbone_pretrained=True, heatmap_backbone_pretrained=False, image_size=512, image_mean=[0.485, 0.456, 0.406], image_std=[0.229, 0.224, 0.225], backbone_out_channels=64, batch_size=16, warmup_epochs=10, model_warmup_epochs=0, loss_warmup_epochs=0, lr_scheduler='ReduceLROnPlateau', reduceLROnPlateau_factor=0.9999999999, reduceLROnPlateau_patience=9999999, reduceLROnPlateau_full_stop=True, multiStepLR_milestones=[20, 40, 60, 80, 100], multiStepLR_gamma=0.5, representation_size=64, mask_hidden_layers=64, using_fpn=False, lesion_detection_use_mask=True, fuse_conv_channels=32, box_head_dropout_rate=0, fuse_depth=4, fusion_strategy='concat', fusion_residule=False, gt_in_train_till=0, measure_test=True, eval_freq=10, use_iobb=True, iou_thrs=array([0.5 , 0.55, 0.6 , 0.65, 0.7 , 0.75, 0.8 , 0.85, 0.9 , 0.95]), maxDets=[1, 5, 10, 30], fiaxtions_mode_input='reporting', fiaxtions_mode_label='reporting', clinical_num=[], clinical_cat=['sbp_discrete', 'dbp_discrete', 'o2sat_discrete', 'resprate_discrete', 'heartrate_discrete', 'temperature_discrete', 'age_discrete', 'acuity_discrete', 'gender'], categorical_col_maps={'sbp_discrete': 3, 'dbp_discrete': 3, 'o2sat_discrete': 4, 'resprate_discrete': 3, 'heartrate_discrete': 3, 'temperature_discrete': 4, 'age_discrete': 2, 'acuity_discrete': 5, 'gender': 2}, clinical_cat_emb_dim=16, clinical_conv_channels=32, clinical_upsample='deconv', chexpert_label_cols=['Atelectasis_chexpert', 'Cardiomegaly_chexpert', 'Consolidation_chexpert', 'Edema_chexpert', 'Enlarged Cardiomediastinum_chexpert', 'Fracture_chexpert', 'Lung Lesion_chexpert', 'Lung Opacity_chexpert', 'No Finding_chexpert', 'Pleural Effusion_chexpert', 'Pleural Other_chexpert', 'Pneumonia_chexpert', 'Pneumothorax_chexpert', 'Support Devices_chexpert'], negbio_label_cols=['Atelectasis_negbio', 'Cardiomegaly_negbio', 'Consolidation_negbio', 'Edema_negbio', 'Enlarged Cardiomediastinum_negbio', 'Fracture_negbio', 'Lung Lesion_negbio', 'Lung Opacity_negbio', 'No Finding_negbio', 'Pleural Effusion_negbio', 'Pleural Other_negbio', 'Pneumonia_negbio', 'Pneumothorax_negbio', 'Support Devices_negbio'], performance_standards=[{'task': 'xray-clinical-cl', 'metric': 'accuracy'}], random_flip=True, use_clinical_df=True, use_physionet_df=True, use_dynamic_weight=True, with_clinical_label=False, clinical_lesion_detection_use_1D_fusion=False, including_clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], including_clinical_cat=['gender'], clinical_use_expander=False, objectness_pos_weight=1, real_stop_patience=99999999999999999, cl_temp=0.1, cl_lambda_0=0.5, cl_pretrained_load_params=[], cl_pj_dim=16, use_pytorch_pretrained_backbone=True)
================================================================================================================================

Best performance model has been saved to: [{'xray-clinical-cl_accuracy': 'xray-clinical-cl_val_accuracy_0_2354_test_accuracy_0_2467_epoch13_08-05-2023 20-47-00_512_image_clinical_resnet18_woaug'}]
The final model has been saved to: [xray-clinical-cl_val_accuracy_0_2221_test_accuracy_0_2134_epoch26_08-06-2023 02-03-54_512_image_clinical_resnet18_woaug]

================================================================================================================================















====================| Epoch [200] Done | It has took [292.25] min, Avg time: [87.67] sec/epoch | Estimate time for [200] epochs: [292.25] min | Epoch took [85] sec |  chexpert-classification_auc Patience [187] |====================
====================| Training Done, start testing! | [200] Epochs Training time: [17536] seconds, Avg time / Epoch: [87.68] seconds====================
====================Best Performance model has been saved to: [{'chexpert-classification_auc': 'chexpert-classification_val_auc_0_7188_test_auc_0_7121_epoch13_08-07-2023 16-13-04_chexpert_cl_no_fix'}]====================
====================The final model has been saved to: [chexpert-classification_val_auc_0_6598_test_auc_0_6543_epoch200_08-07-2023 20-45-12_chexpert_cl_no_fix]====================
========================================For Training [chexpert_cl_fix]========================================
ModelSetup(get_performance_iou=None, get_performance_areaRng='all', name='chexpert_cl_fix', sources=['xrays'], tasks=['chexpert-classification'], fusor='element-wise sum', using_backbone_for_clinical=True, decoder_channels=[128, 64, 32, 16, 8], lesion_label_cols=['Pulmonary edema', 'Enlarged cardiac silhouette', 'Consolidation', 'Atelectasis', 'Pleural abnormality'], save_early_stop_model=True, normalise_clinical_num=True, record_training_performance=False, backbone='resnet18', optimiser='sgd', lr=0.0001, weight_decay=0.0001, sgb_momentum=0.9, use_aug_for_cl=False, image_backbone_pretrained=True, heatmap_backbone_pretrained=False, image_size=512, image_mean=[0.485, 0.456, 0.406], image_std=[0.229, 0.224, 0.225], backbone_out_channels=None, batch_size=4, warmup_epochs=10, model_warmup_epochs=0, loss_warmup_epochs=0, lr_scheduler='ReduceLROnPlateau', reduceLROnPlateau_factor=0.9999999999, reduceLROnPlateau_patience=9999999, reduceLROnPlateau_full_stop=True, multiStepLR_milestones=[20, 40, 60, 80, 100], multiStepLR_gamma=0.5, representation_size=64, mask_hidden_layers=64, using_fpn=False, lesion_detection_use_mask=True, fuse_conv_channels=32, box_head_dropout_rate=0, fuse_depth=4, fusion_strategy='concat', fusion_residule=False, gt_in_train_till=0, measure_test=True, eval_freq=10, use_iobb=True, iou_thrs=array([0.5 , 0.55, 0.6 , 0.65, 0.7 , 0.75, 0.8 , 0.85, 0.9 , 0.95]), maxDets=[1, 5, 10, 30], fiaxtions_mode_input='reporting', fiaxtions_mode_label='reporting', clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], clinical_cat=['gender'], categorical_col_maps={'gender': 2}, clinical_cat_emb_dim=16, clinical_conv_channels=32, clinical_upsample='deconv', chexpert_label_cols=['Atelectasis_chexpert', 'Cardiomegaly_chexpert', 'Consolidation_chexpert', 'Edema_chexpert', 'Enlarged Cardiomediastinum_chexpert', 'Fracture_chexpert', 'Lung Lesion_chexpert', 'Lung Opacity_chexpert', 'No Finding_chexpert', 'Pleural Effusion_chexpert', 'Pleural Other_chexpert', 'Pneumonia_chexpert', 'Pneumothorax_chexpert', 'Support Devices_chexpert'], negbio_label_cols=['Atelectasis_negbio', 'Cardiomegaly_negbio', 'Consolidation_negbio', 'Edema_negbio', 'Enlarged Cardiomediastinum_negbio', 'Fracture_negbio', 'Lung Lesion_negbio', 'Lung Opacity_negbio', 'No Finding_negbio', 'Pleural Effusion_negbio', 'Pleural Other_negbio', 'Pneumonia_negbio', 'Pneumothorax_negbio', 'Support Devices_negbio'], performance_standards=[{'task': 'chexpert-classification', 'metric': 'auc'}], random_flip=True, use_clinical_df=True, use_physionet_df=False, use_dynamic_weight=True, with_clinical_label=False, clinical_lesion_detection_use_1D_fusion=False, including_clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], including_clinical_cat=['gender'], clinical_use_expander=False, objectness_pos_weight=1, real_stop_patience=99999999999999999, cl_temp=0.1, cl_lambda_0=0.5, cl_pretrained_load_params=[<models.load.CLPretrainedLoadParams object at 0x00000242B4717190>], cl_pj_dim=16, use_pytorch_pretrained_backbone=True)
==============================================================================================================

Best performance model has been saved to: [{'chexpert-classification_auc': 'chexpert-classification_val_auc_0_7317_test_auc_0_7096_epoch182_08-07-2023 15-27-28_chexpert_cl_fix'}]
The final model has been saved to: [chexpert-classification_val_auc_0_6859_test_auc_0_6711_epoch200_08-07-2023 15-52-55_chexpert_cl_fix]

==============================================================================================================


========================================For Training [chexpert_cl_no_fix]========================================
ModelSetup(get_performance_iou=None, get_performance_areaRng='all', name='chexpert_cl_no_fix', sources=['xrays'], tasks=['chexpert-classification'], fusor='element-wise sum', using_backbone_for_clinical=True, decoder_channels=[128, 64, 32, 16, 8], lesion_label_cols=['Pulmonary edema', 'Enlarged cardiac silhouette', 'Consolidation', 'Atelectasis', 'Pleural abnormality'], save_early_stop_model=True, normalise_clinical_num=True, record_training_performance=False, backbone='resnet18', optimiser='sgd', lr=0.0001, weight_decay=0.0001, sgb_momentum=0.9, use_aug_for_cl=False, image_backbone_pretrained=True, heatmap_backbone_pretrained=False, image_size=512, image_mean=[0.485, 0.456, 0.406], image_std=[0.229, 0.224, 0.225], backbone_out_channels=None, batch_size=4, warmup_epochs=10, model_warmup_epochs=0, loss_warmup_epochs=0, lr_scheduler='ReduceLROnPlateau', reduceLROnPlateau_factor=0.9999999999, reduceLROnPlateau_patience=9999999, reduceLROnPlateau_full_stop=True, multiStepLR_milestones=[20, 40, 60, 80, 100], multiStepLR_gamma=0.5, representation_size=64, mask_hidden_layers=64, using_fpn=False, lesion_detection_use_mask=True, fuse_conv_channels=32, box_head_dropout_rate=0, fuse_depth=4, fusion_strategy='concat', fusion_residule=False, gt_in_train_till=0, measure_test=True, eval_freq=10, use_iobb=True, iou_thrs=array([0.5 , 0.55, 0.6 , 0.65, 0.7 , 0.75, 0.8 , 0.85, 0.9 , 0.95]), maxDets=[1, 5, 10, 30], fiaxtions_mode_input='reporting', fiaxtions_mode_label='reporting', clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], clinical_cat=['gender'], categorical_col_maps={'gender': 2}, clinical_cat_emb_dim=16, clinical_conv_channels=32, clinical_upsample='deconv', chexpert_label_cols=['Atelectasis_chexpert', 'Cardiomegaly_chexpert', 'Consolidation_chexpert', 'Edema_chexpert', 'Enlarged Cardiomediastinum_chexpert', 'Fracture_chexpert', 'Lung Lesion_chexpert', 'Lung Opacity_chexpert', 'No Finding_chexpert', 'Pleural Effusion_chexpert', 'Pleural Other_chexpert', 'Pneumonia_chexpert', 'Pneumothorax_chexpert', 'Support Devices_chexpert'], negbio_label_cols=['Atelectasis_negbio', 'Cardiomegaly_negbio', 'Consolidation_negbio', 'Edema_negbio', 'Enlarged Cardiomediastinum_negbio', 'Fracture_negbio', 'Lung Lesion_negbio', 'Lung Opacity_negbio', 'No Finding_negbio', 'Pleural Effusion_negbio', 'Pleural Other_negbio', 'Pneumonia_negbio', 'Pneumothorax_negbio', 'Support Devices_negbio'], performance_standards=[{'task': 'chexpert-classification', 'metric': 'auc'}], random_flip=True, use_clinical_df=True, use_physionet_df=False, use_dynamic_weight=True, with_clinical_label=False, clinical_lesion_detection_use_1D_fusion=False, including_clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], including_clinical_cat=['gender'], clinical_use_expander=False, objectness_pos_weight=1, real_stop_patience=99999999999999999, cl_temp=0.1, cl_lambda_0=0.5, cl_pretrained_load_params=[<models.load.CLPretrainedLoadParams object at 0x00000242B4717160>], cl_pj_dim=16, use_pytorch_pretrained_backbone=True)
=================================================================================================================

Best performance model has been saved to: [{'chexpert-classification_auc': 'chexpert-classification_val_auc_0_7188_test_auc_0_7121_epoch13_08-07-2023 16-13-04_chexpert_cl_no_fix'}]
The final model has been saved to: [chexpert-classification_val_auc_0_6598_test_auc_0_6543_epoch200_08-07-2023 20-45-12_chexpert_cl_no_fix]

=================================================================================================================


### No aug, backbone = None

========================================For Training [chexpert_cl_fix]========================================
ModelSetup(get_performance_iou=None, get_performance_areaRng='all', name='chexpert_cl_fix', sources=['xrays'], tasks=['chexpert-classification'], fusor='element-wise sum', using_backbone_for_clinical=True, decoder_channels=[128, 64, 32, 16, 8], lesion_label_cols=['Pulmonary edema', 'Enlarged cardiac silhouette', 'Consolidation', 'Atelectasis', 'Pleural abnormality'], save_early_stop_model=True, normalise_clinical_num=True, record_training_performance=False, backbone='resnet18', optimiser='sgd', lr=0.0001, weight_decay=0.0001, sgb_momentum=0.9, use_aug_for_cl=False, image_backbone_pretrained=True, heatmap_backbone_pretrained=False, image_size=512, image_mean=[0.485, 0.456, 0.406], image_std=[0.229, 0.224, 0.225], backbone_out_channels=None, batch_size=4, warmup_epochs=10, model_warmup_epochs=0, loss_warmup_epochs=0, lr_scheduler='ReduceLROnPlateau', reduceLROnPlateau_factor=0.9999999999, reduceLROnPlateau_patience=9999999, reduceLROnPlateau_full_stop=True, multiStepLR_milestones=[20, 40, 60, 80, 100], multiStepLR_gamma=0.5, representation_size=64, mask_hidden_layers=64, using_fpn=False, lesion_detection_use_mask=True, fuse_conv_channels=32, box_head_dropout_rate=0, fuse_depth=4, fusion_strategy='concat', fusion_residule=False, gt_in_train_till=0, measure_test=True, eval_freq=10, use_iobb=True, iou_thrs=array([0.5 , 0.55, 0.6 , 0.65, 0.7 , 0.75, 0.8 , 0.85, 0.9 , 0.95]), maxDets=[1, 5, 10, 30], fiaxtions_mode_input='reporting', fiaxtions_mode_label='reporting', clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], clinical_cat=['gender'], categorical_col_maps={'gender': 2}, clinical_cat_emb_dim=16, clinical_conv_channels=32, clinical_upsample='deconv', chexpert_label_cols=['Atelectasis_chexpert', 'Cardiomegaly_chexpert', 'Consolidation_chexpert', 'Edema_chexpert', 'Enlarged Cardiomediastinum_chexpert', 'Fracture_chexpert', 'Lung Lesion_chexpert', 'Lung Opacity_chexpert', 'No Finding_chexpert', 'Pleural Effusion_chexpert', 'Pleural Other_chexpert', 'Pneumonia_chexpert', 'Pneumothorax_chexpert', 'Support Devices_chexpert'], negbio_label_cols=['Atelectasis_negbio', 'Cardiomegaly_negbio', 'Consolidation_negbio', 'Edema_negbio', 'Enlarged Cardiomediastinum_negbio', 'Fracture_negbio', 'Lung Lesion_negbio', 'Lung Opacity_negbio', 'No Finding_negbio', 'Pleural Effusion_negbio', 'Pleural Other_negbio', 'Pneumonia_negbio', 'Pneumothorax_negbio', 'Support Devices_negbio'], performance_standards=[{'task': 'chexpert-classification', 'metric': 'auc'}], random_flip=True, use_clinical_df=True, use_physionet_df=False, use_dynamic_weight=True, with_clinical_label=False, clinical_lesion_detection_use_1D_fusion=False, including_clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], including_clinical_cat=['gender'], clinical_use_expander=False, objectness_pos_weight=1, real_stop_patience=99999999999999999, cl_temp=0.1, cl_lambda_0=0.5, cl_pretrained_load_params=[<models.load.CLPretrainedLoadParams object at 0x00000242B4717190>], cl_pj_dim=16, use_pytorch_pretrained_backbone=True)
==============================================================================================================

Best performance model has been saved to: [{'chexpert-classification_auc': 'chexpert-classification_val_auc_0_7317_test_auc_0_7096_epoch182_08-07-2023 15-27-28_chexpert_cl_fix'}]
The final model has been saved to: [chexpert-classification_val_auc_0_6859_test_auc_0_6711_epoch200_08-07-2023 15-52-55_chexpert_cl_fix]

==============================================================================================================


####
========================================For Training [chexpert_cl_no_fix]========================================
ModelSetup(get_performance_iou=None, get_performance_areaRng='all', name='chexpert_cl_no_fix', sources=['xrays'], tasks=['chexpert-classification'], fusor='element-wise sum', using_backbone_for_clinical=True, decoder_channels=[128, 64, 32, 16, 8], lesion_label_cols=['Pulmonary edema', 'Enlarged cardiac silhouette', 'Consolidation', 'Atelectasis', 'Pleural abnormality'], save_early_stop_model=True, normalise_clinical_num=True, record_training_performance=False, backbone='resnet18', optimiser='sgd', lr=0.0001, weight_decay=0.0001, sgb_momentum=0.9, use_aug_for_cl=False, image_backbone_pretrained=True, heatmap_backbone_pretrained=False, image_size=512, image_mean=[0.485, 0.456, 0.406], image_std=[0.229, 0.224, 0.225], backbone_out_channels=None, batch_size=4, warmup_epochs=10, model_warmup_epochs=0, loss_warmup_epochs=0, lr_scheduler='ReduceLROnPlateau', reduceLROnPlateau_factor=0.9999999999, reduceLROnPlateau_patience=9999999, reduceLROnPlateau_full_stop=True, multiStepLR_milestones=[20, 40, 60, 80, 100], multiStepLR_gamma=0.5, representation_size=64, mask_hidden_layers=64, using_fpn=False, lesion_detection_use_mask=True, fuse_conv_channels=32, box_head_dropout_rate=0, fuse_depth=4, fusion_strategy='concat', fusion_residule=False, gt_in_train_till=0, measure_test=True, eval_freq=10, use_iobb=True, iou_thrs=array([0.5 , 0.55, 0.6 , 0.65, 0.7 , 0.75, 0.8 , 0.85, 0.9 , 0.95]), maxDets=[1, 5, 10, 30], fiaxtions_mode_input='reporting', fiaxtions_mode_label='reporting', clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], clinical_cat=['gender'], categorical_col_maps={'gender': 2}, clinical_cat_emb_dim=16, clinical_conv_channels=32, clinical_upsample='deconv', chexpert_label_cols=['Atelectasis_chexpert', 'Cardiomegaly_chexpert', 'Consolidation_chexpert', 'Edema_chexpert', 'Enlarged Cardiomediastinum_chexpert', 'Fracture_chexpert', 'Lung Lesion_chexpert', 'Lung Opacity_chexpert', 'No Finding_chexpert', 'Pleural Effusion_chexpert', 'Pleural Other_chexpert', 'Pneumonia_chexpert', 'Pneumothorax_chexpert', 'Support Devices_chexpert'], negbio_label_cols=['Atelectasis_negbio', 'Cardiomegaly_negbio', 'Consolidation_negbio', 'Edema_negbio', 'Enlarged Cardiomediastinum_negbio', 'Fracture_negbio', 'Lung Lesion_negbio', 'Lung Opacity_negbio', 'No Finding_negbio', 'Pleural Effusion_negbio', 'Pleural Other_negbio', 'Pneumonia_negbio', 'Pneumothorax_negbio', 'Support Devices_negbio'], performance_standards=[{'task': 'chexpert-classification', 'metric': 'auc'}], random_flip=True, use_clinical_df=True, use_physionet_df=False, use_dynamic_weight=True, with_clinical_label=False, clinical_lesion_detection_use_1D_fusion=False, including_clinical_num=['age', 'temperature', 'heartrate', 'resprate', 'o2sat', 'sbp', 'dbp', 'acuity'], including_clinical_cat=['gender'], clinical_use_expander=False, objectness_pos_weight=1, real_stop_patience=99999999999999999, cl_temp=0.1, cl_lambda_0=0.5, cl_pretrained_load_params=[<models.load.CLPretrainedLoadParams object at 0x00000242B4717160>], cl_pj_dim=16, use_pytorch_pretrained_backbone=True)
=================================================================================================================

Best performance model has been saved to: [{'chexpert-classification_auc': 'chexpert-classification_val_auc_0_7188_test_auc_0_7121_epoch13_08-07-2023 16-13-04_chexpert_cl_no_fix'}]
The final model has been saved to: [chexpert-classification_val_auc_0_6598_test_auc_0_6543_epoch200_08-07-2023 20-45-12_chexpert_cl_no_fix]

=================================================================================================================








########## 

chexpert_cl_fix
best at 182 epoch
{'chexpert-classification': {'f1': 0.536964980544747, 'precision': 0.69, 'accuracy': 0.9291666666666667, 'recall': 0.4394904458598726, 'auc': 0.7095679412490433}}
chexpert_cl_no_fix
best at 13 epoch
{'chexpert-classification': {'f1': 0.5384615384615385, 'precision': 0.6796116504854369, 'accuracy': 0.9285714285714286, 'recall': 0.445859872611465, 'auc': 0.7120960558067173}}